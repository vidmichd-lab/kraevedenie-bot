# Безопасность бота

## Защита от несанкционированного доступа

Бот защищен следующими мерами безопасности:

### 1. Проверка прав доступа
- Админ-бот доступен только пользователям, указанным в `ADMIN_IDS` в файле `.env`
- Все попытки несанкционированного доступа логируются

### 2. Валидация входных данных
- Проверка формата дат (YYYY-MM-DD)
- Валидация URL (только http:// и https://)
- Ограничение длины текста (заголовок до 200 символов, описание до 2000)
- Очистка опасных символов

### 3. Логирование безопасности
- Все подозрительные действия записываются в файл `security.log`
- Логируются: время, ID пользователя, username, действие, детали

### 4. Защита токенов
- Токены хранятся только в файле `.env` (не коммитится в Git)
- Файл `.env` добавлен в `.gitignore`

## Рекомендации по безопасности

### ✅ Что нужно сделать:

1. **Настройте ADMIN_IDS**
   ```
   ADMIN_IDS=ваш_telegram_id,id_второго_админа
   ```
   Получить свой ID можно через [@userinfobot](https://t.me/userinfobot)

2. **Не делитесь токенами**
   - Никогда не публикуйте токены в открытом доступе
   - Не отправляйте токены в сообщениях
   - Не коммитьте `.env` в Git

3. **Регулярно проверяйте логи**
   - Просматривайте файл `security.log` на предмет подозрительной активности
   - Если видите попытки доступа от неизвестных пользователей - это нормально (они просто не смогут получить доступ)

4. **Используйте сильные токены**
   - Токены генерируются автоматически BotFather - они уже достаточно безопасны
   - Если токен скомпрометирован - создайте нового бота и замените токен

5. **Ограничьте доступ к серверу**
   - Если бот работает на сервере - используйте SSH ключи
   - Ограничьте доступ к файлам `.env` и `security.log`

## Что делать при подозрении на взлом

1. **Немедленно замените токены**
   - Создайте нового бота через @BotFather
   - Обновите токены в `.env`
   - Перезапустите ботов

2. **Проверьте логи**
   - Откройте `security.log`
   - Найдите подозрительную активность
   - Определите, кто пытался получить доступ

3. **Проверьте события**
   - Откройте `data/events.json`
   - Убедитесь, что нет несанкционированных изменений

4. **Обновите ADMIN_IDS**
   - Убедитесь, что в списке только доверенные пользователи
   - Удалите подозрительные ID

## Мониторинг

Регулярно проверяйте:
- ✅ Файл `security.log` на подозрительную активность
- ✅ Список подписчиков на необычные изменения
- ✅ События в `data/events.json` на несанкционированные правки
- ✅ Логи бота на ошибки

## Дополнительная защита (опционально)

Для еще большей безопасности можно:
- Использовать вебхуки вместо polling (для production)
- Настроить firewall на сервере
- Использовать VPN для доступа к серверу
- Настроить автоматические бэкапы базы данных

